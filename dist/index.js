var e,t=require("react"),n=(e=t)&&"object"==typeof e&&"default"in e?e.default:e,r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var o,i=function(e,t){return e(t={exports:{}},t.exports),t.exports}(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n);function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=13,c=9,u=8,d=89,f=90,p=77,h=57,y=219,g=222,m=192,v=100,_=3e3,b="navigator"in r&&/Win/i.test(navigator.platform),S="navigator"in r&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),C="npm__react-simple-code-editor__textarea",k=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,a=Array(i),C=0;C<i;C++)a[C]=arguments[C];return n=r=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.state={capture:!0},r._recordCurrentState=function(){var e=r._input;e&&r._recordChange({value:e.value,selectionStart:e.selectionStart,selectionEnd:e.selectionEnd})},r._getLines=function(e,t){return e.substring(0,t).split("\n")},r._recordChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=r._history,i=n.stack,a=n.offset;if(i.length&&a>-1){r._history.stack=i.slice(0,a+1);var s=r._history.stack.length;if(s>v){var l=s-v;r._history.stack=i.slice(l,s),r._history.offset=Math.max(r._history.offset-l,0)}}var c=Date.now();if(t){var u=r._history.stack[r._history.offset];if(u&&c-u.timestamp<_){var d=/[^a-z0-9]([a-z0-9]+)$/i,f=r._getLines(u.value,u.selectionStart).pop().match(d),p=r._getLines(e.value,e.selectionStart).pop().match(d);if(f&&p&&p[1].startsWith(f[1]))return void(r._history.stack[r._history.offset]=o({},e,{timestamp:c}))}}r._history.stack.push(o({},e,{timestamp:c})),r._history.offset++},r._updateInput=function(e){var t=r._input;t&&(t.value=e.value,t.selectionStart=e.selectionStart,t.selectionEnd=e.selectionEnd,r.props.onValueChange(e.value))},r._applyEdits=function(e){var t=r._input,n=r._history.stack[r._history.offset];n&&t&&(r._history.stack[r._history.offset]=o({},n,{selectionStart:t.selectionStart,selectionEnd:t.selectionEnd})),r._recordChange(e),r._updateInput(e)},r._undoEdit=function(){var e=r._history,t=e.offset,n=e.stack[t-1];n&&(r._updateInput(n),r._history.offset=Math.max(t-1,0))},r._redoEdit=function(){var e=r._history,t=e.stack,n=e.offset,o=t[n+1];o&&(r._updateInput(o),r._history.offset=Math.min(n+1,t.length-1))},r._handleKeyDown=function(e){var t=r.props,n=t.tabSize,o=t.insertSpaces,i=t.ignoreTabKey,a=t.onKeyDown;if(!a||(a(e),!e.defaultPrevented)){var s=e.target,v=s.value,_=s.selectionStart,C=s.selectionEnd,k=(o?" ":"     ").repeat(n);if(e.keyCode===c&&!i&&r.state.capture)if(e.preventDefault(),e.shiftKey){var E=r._getLines(v,_),O=E.length-1,x=r._getLines(v,C).length-1,w=v.split("\n").map(function(e,t){return t>=O&&t<=x&&e.startsWith(k)?e.substring(k.length):e}).join("\n");if(v!==w)r._applyEdits({value:w,selectionStart:E[O].startsWith(k)?_-k.length:_,selectionEnd:C-(v.length-w.length)})}else if(_!==C){var K=r._getLines(v,_),j=K.length-1,D=r._getLines(v,C).length-1,L=K[j];r._applyEdits({value:v.split("\n").map(function(e,t){return t>=j&&t<=D?k+e:e}).join("\n"),selectionStart:/\S/.test(L)?_+k.length:_,selectionEnd:C+k.length*(D-j+1)})}else{var I=_+k.length;r._applyEdits({value:v.substring(0,_)+k+v.substring(C),selectionStart:I,selectionEnd:I})}else if(e.keyCode===u){var M=_!==C;if(v.substring(0,_).endsWith(k)&&!M){e.preventDefault();var T=_-k.length;r._applyEdits({value:v.substring(0,_-k.length)+v.substring(C),selectionStart:T,selectionEnd:T})}}else if(e.keyCode===l){if(_===C){var P=r._getLines(v,_).pop().match(/^\s+/);if(P&&P[0]){e.preventDefault();var R="\n"+P[0],z=_+R.length;r._applyEdits({value:v.substring(0,_)+R+v.substring(C),selectionStart:z,selectionEnd:z})}}}else if(e.keyCode===h||e.keyCode===y||e.keyCode===g||e.keyCode===m){var F=void 0;e.keyCode===h&&e.shiftKey?F=["(",")"]:e.keyCode===y?F=e.shiftKey?["{","}"]:["[","]"]:e.keyCode===g?F=e.shiftKey?['"','"']:["'","'"]:e.keyCode!==m||e.shiftKey||(F=["`","`"]),_!==C&&F&&(e.preventDefault(),r._applyEdits({value:v.substring(0,_)+F[0]+v.substring(_,C)+F[1]+v.substring(C),selectionStart:_,selectionEnd:C+2}))}else(S?e.metaKey&&e.keyCode===f:e.ctrlKey&&e.keyCode===f)&&!e.shiftKey&&!e.altKey?(e.preventDefault(),r._undoEdit()):(S?e.metaKey&&e.keyCode===f&&e.shiftKey:b?e.ctrlKey&&e.keyCode===d:e.ctrlKey&&e.keyCode===f&&e.shiftKey)&&!e.altKey?(e.preventDefault(),r._redoEdit()):e.keyCode!==p||!e.ctrlKey||S&&!e.shiftKey||(e.preventDefault(),r.setState(function(e){return{capture:!e.capture}}))}},r._handleChange=function(e){var t=e.target,n=t.value;r._recordChange({value:n,selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},!0),r.props.onValueChange(n)},r._history={stack:[],offset:-1},s(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),i(t,[{key:"componentDidMount",value:function(){this._recordCurrentState()}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,r=t.style,i=t.padding,s=t.highlight,l=t.textareaId,c=t.autoFocus,u=t.disabled,d=t.form,f=t.maxLength,p=t.minLength,h=t.name,y=t.placeholder,g=t.readOnly,m=t.required,v=t.onClick,_=t.onFocus,b=t.onBlur,S=t.onKeyUp,k=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["value","style","padding","highlight","textareaId","autoFocus","disabled","form","maxLength","minLength","name","placeholder","readOnly","required","onClick","onFocus","onBlur","onKeyUp","onKeyDown","onValueChange","tabSize","insertSpaces","ignoreTabKey"]),O={paddingTop:i,paddingRight:i,paddingBottom:i,paddingLeft:i},x=s(n);return a.createElement("div",o({},k,{style:o({},E.container,r)}),a.createElement("textarea",{ref:function(t){return e._input=t},style:o({},E.editor,E.textarea,O),className:C,id:l,value:n,onChange:this._handleChange,onKeyDown:this._handleKeyDown,onClick:v,onKeyUp:S,onFocus:_,onBlur:b,disabled:u,form:d,maxLength:f,minLength:p,name:h,placeholder:y,readOnly:g,required:m,autoFocus:c,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"data-gramm":!1}),a.createElement("pre",o({"aria-hidden":"true",style:o({},E.editor,E.highlight,O)},"string"==typeof x?{dangerouslySetInnerHTML:{__html:x+"<br />"}}:{children:x})),a.createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:"\n/**\n * Reset the text fill color so that placeholder is visible\n */\n.npm__react-simple-code-editor__textarea:empty {\n  -webkit-text-fill-color: inherit !important;\n}\n\n/**\n * Hack to apply on some CSS on IE10 and IE11\n */\n@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {\n  /**\n    * IE doesn't support '-webkit-text-fill-color'\n    * So we use 'color: transparent' to make the text transparent on IE\n    * Unlike other browsers, it doesn't affect caret color in IE\n    */\n  .npm__react-simple-code-editor__textarea {\n    color: transparent !important;\n  }\n\n  .npm__react-simple-code-editor__textarea::selection {\n    background-color: #accef7 !important;\n    color: transparent !important;\n  }\n}\n"}}))}},{key:"session",get:function(){return{history:this._history}},set:function(e){this._history=e.history}}]),t}();k.defaultProps={tabSize:2,insertSpaces:!0,ignoreTabKey:!1,padding:0},t.default=k;var E={container:{position:"relative",textAlign:"left",whiteSpace:"pre-wrap",wordBreak:"keep-all",boxSizing:"border-box",padding:0},textarea:{position:"absolute",top:0,left:0,height:"100%",width:"100%",margin:0,border:0,resize:"none",background:"none",overflow:"hidden",color:"inherit",MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",WebkitTextFillColor:"transparent"},highlight:{position:"relative",margin:0,border:0,pointerEvents:"none"},editor:{boxSizing:"inherit",display:"inherit",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontVariantLigatures:"inherit",fontWeight:"inherit",letterSpacing:"inherit",lineHeight:"inherit",tabSize:"inherit",textIndent:"inherit",textRendering:"inherit",textTransform:"inherit",whiteSpace:"inherit",wordBreak:"inherit"}}}),a=(o=i)&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;function s(e){return{end:e.selectionEnd,start:e.selectionStart}}module.exports=function(e){var r,o=e.initialValue,i=e.formatCode,l=e.formatOnSave,c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&-1===t.indexOf(r)&&(n[r]=e[r]);return n}(e,["initialValue","formatCode","formatOnSave"]),u=t.useReducer((r={formatCode:i},function(e,t){switch(t.type){case"EDIT":return Object.assign({},e,{code:t.payload});case"COMMENT_LINE":var n=t.payload,o=n.lineNumber,i=n.selectionState,a=!1,s=e.code.split("\n").reduce(function(e,t,n){return n+1===o?(t.startsWith("// ")&&(a=!0),e.concat([t.startsWith("// ")?t.split("// ")[1]:"// "+t])):e.concat([t])},[]).join("\n");return Object.assign({},e,{selectionState:i,code:s,didRemoveComment:a});case"FORMAT_CODE":return Object.assign({},e,{code:r.formatCode(e.code),selectionState:t.payload});default:return e}}),{code:o,selectionState:{end:0,start:0},didRemoveComment:!1}),d=u[0],f=u[1],p=t.useRef(null),h=t.useRef(!1);t.useEffect(function(){p.current=document.querySelector("#react-complex-code-editor--element"),h.current=navigator.userAgent.includes("Mac OS X")},[]),t.useEffect(function(){p.current.selectionEnd=d.didRemoveComment?d.selectionState.start-3:d.selectionState.start+3,p.current.selectionStart=d.didRemoveComment?d.selectionState.start-3:d.selectionState.start+3},[d.selectionState,d.didRemoveComment]);var y=t.useCallback(function(e){if("/"===e.key&&h.current&&e.metaKey||"/"===e.key&&!h.current&&e.ctrlKey){var t=s(p.current),n=d.code.substr(0,t.start).split("\n").length;f({type:"COMMENT_LINE",payload:{lineNumber:n,selectionState:t}})}else if(l&&"function"==typeof i&&("s"===e.key&&h.current&&e.metaKey||"s"===e.key&&!h.current&&e.ctrlKey)){var r=s(p.current);e.preventDefault(),f({type:"FORMAT_CODE",payload:r})}},[d.code]),g=t.useCallback(function(e){return f({type:"EDIT",payload:e})},[]);return n.createElement(a,Object.assign({},c,{value:d.code,onValueChange:g,textareaId:"react-complex-code-editor--element",onKeyDown:y}))};
//# sourceMappingURL=index.js.map
